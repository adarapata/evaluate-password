/*
evaluatePassword v1.0.0
Author: taknakamu
Git: https://github.com/taknakamu/evaluate-password

Copyright (c) 2013 Kosuke Nakamuta
Licensed under the MIT license: http://www.opensource.org/licenses/mit-license.php
*/
(function(a){a.fn.extend({evaluatePassword:function(){var h={minimum_length:8,runOnInit:true,autoCreateForm:true,dictionaryCheck:true,dictionaryJsonPath:"../dicrionay.json",requireStringKind:1};var e={"0":"短すぎます","1":"低","2":"中","3":"良好","4":"高"};var b=["[a-z]","[A-Z]","[0-9]","-_"];var c=null;if(h.dictionaryCheck){a.getJSON(h.dictionaryJsonPath,function(i){c=i})}var g=a("[data-target="+a(this).attr("id")+"]");if(h.autoCreateForm){d()}function d(){g.append(a("<b/>").text("パスワードの安全度：")).append(a("<span/>").addClass("password-status")).append(a("<div/>").addClass("password-bar").append(a("<div/>").addClass("password-level")))}function f(){var k=a(this).val();var n=k.length;var l=a(this).attr("id");var p=g.find(".password-status");var i=g.find("[class^=password-level]");var j=0;i.removeClass();if(n<h.minimum_length){j=0}else{if(h.minimum_length<=n&&n<=10){j=1}else{if(11<=n){j=2}}var q={};a(k.split("")).each(function(s,r){q[r]=1});var o=0;a.each(q,function(){o++});if(o<=1){if(k.match(/a|q|z|o|m|[0-9]/)&&j===2&&12<=n&&n<=18){if(n%2===1){j--}}}else{if(o<=4){j++}else{if(5<=o){j+=2}}}var m=0;a.each(b,function(s,r){if(k.match(new RegExp(r))){m++}});if(m<h.requireStringKind){j=1}if(c){a.each(c,function(s,r){if(k.match(new RegExp(r))&&r.length<17){if(""===k.replace(new RegExp(r,"g"),"")){j=1}}})}}p.text(e[j]);i.addClass("password-level"+j);return j}if(h.runOnInit){this.each(function(){return f.apply(this)})}return this.each(function(){a(this).bind("keyup focus",f)})}})})(jQuery);